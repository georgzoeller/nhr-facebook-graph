// Generated by CoffeeScript 2.3.2
(function() {
  module.exports = function(context) {
    return {
      getProfile: function(user_id) {
        return context.createCall({
          endpoint: `${user_id}`
        }).describe(`Requesting profile for user ${user_id}`).setMethod('GET').authorizeByToken().setFields(['id', 'first_name', 'last_name', 'profile_pic', 'locale', 'timezone', 'gender']).setResultsTransform((function(profile) {
          profile.picture = profile.profile_pic;
          return profile;
        }));
      },
      resolveEmail: function(email) {
        return context.createCall({
          endpoint: `${email}`
        }).describe(`Resolving ${email} to id.`).setMethod('GET').setFields(['id']);
      },
      getImpersonationToken: function(user_id) {
        return context.createCall({
          endpoint: `${user_id}`
        }).describe(`Requesting impersonation token for for user ${user_id}`).setMethod('GET').authorizeByToken().setFields(['id', 'impersonate_token']).setResultsTransform(function(resp) {
          return resp['impersonate_token'];
        });
      },
      postToFeed: function(user_id, {message, markdown = false}) {
        var formatting;
        formatting = 'PLAINTEXT';
        if (markdown) {
          formatting = 'MARKDOWN';
        }
        return context.createCall({
          endpoint: `${user_id}/feed`
        }).describe(`creating post to (${user_id}/feed`).authorizeByToken().setMethod('POST').setJson({
          message: message,
          formatting: formatting
        });
      }
    };
  };

}).call(this);
